@page
@model BuildingViewModel
@{
    ViewData["Title"] = "View Building";
}

<script src="lib/jquery/dist/jquery.min.js"></script>
<script src="lib/scripts/jquery.rwdImageMaps.min.js"></script>

<div class="container">
    <div>
        <h1 class="heading1">@Html.DisplayFor(modelItem => Model.Building.Name)</h1>
        <p class="p4">(Click a link or highlighted, coloured box to see more about that room or lab.)</p>
        <div class="box3-container d-flex flex-column flex-wrap flex-md-row justify-content-start">
            @foreach(var floor in Model.Building.Floors)
            {
                string pictureSrc = $"data:image/jpeg;base64,{Convert.ToBase64String(floor.MapImage)}";
                string pictureId = floor.Id.ToString();

                <div class=" box3">
                    <div>
                        <h5> @Html.DisplayFor(modelItem => floor.Name)</h5>
                    </div>

                    <h5>Laboratories</h5>
                    @foreach(var room in floor.Rooms)
                    {
                        <div>
                            <ul>
                                <li><a asp-page="./RoomView" asp-route-roomCode="@room.Code">@Html.DisplayFor(modelItem => room.Code) - @Html.DisplayFor(modelItem => room.Name)</a></li>
                            </ul>
                        </div>
                    }
                    <h5>Interactive Map</h5>
                    @* Interactive map section *@

                    <div>
                        <!-- Image Map Generated by http://www.image-map.net/ -->
                        <img src="@pictureSrc" usemap="#image-map @pictureId" class="building-img">
               
                        <map name="image-map @pictureId">
                            @foreach(var room in floor.Rooms)
                            {
                                <area target="" alt="" title="" href="./RoomView?roomCode=@room.Code" coords="@room.MapHotspot.PointOneX,@room.MapHotspot.PointOneY,@room.MapHotspot.PointTwoX,@room.MapHotspot.PointTwoY" shape="rect">
                                @* Script from https://github.com/stowball/jQuery-rwdImageMaps *@
                                <script>$('img[usemap]').rwdImageMaps();</script> 
                                @* end of script from https://github.com/stowball/jQuery-rwdImageMaps *@
                            }
                        </map>
                    </div>
                    @* End End of interactive map *@

                </div>
            }
        </div>
    </div>
</div>


